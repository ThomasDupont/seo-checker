{"version":3,"file":"fiberRefs.js","names":["Arr","Equal","dual","pipe","HashSet","Option","pipeArguments","core","unsafeMake","fiberRefLocals","FiberRefsImpl","empty","Map","FiberRefsSym","Symbol","for","locals","constructor","arguments","findAncestor","_ref","_parentStack","_childStack","_childModified","ref","parentStack","childStack","childModified","ret","undefined","isNonEmptyReadonlyArray","parentFiberId","headNonEmpty","parentAncestors","tailNonEmpty","childFiberId","childRefValue","childAncestors","startTimeMillis","id","initial","joinAs","self","fiberId","that","parentFiberRefs","forEach","fiberRef","childValue","symbol","has","equals","set","join","get","ancestor","wasModified","patch","diff","oldValue","newValue","newStack","slice","forkAs","childId","map","unsafeForkAs","stack","fork","fiberRefs","fromIterable","keys","setAll","forEachSequentialDiscard","fiberRefSet","getOrDefault","delete_","delete","none","some","getOrElse","updateAs","value","size","unsafeUpdateAs","oldStack","currentId","currentValue","updateManyAs","entries","values","length"],"sources":["../../../src/internal/fiberRefs.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}